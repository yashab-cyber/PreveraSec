<?xml version="1.0" encoding="UTF-8"?>
<svg width="1200" height="800" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <!-- Gradients for different component types -->
    <linearGradient id="inputGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#e1f5fe;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#b3e5fc;stop-opacity:1" />
    </linearGradient>
    
    <linearGradient id="processGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#f3e5f5;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#e1bee7;stop-opacity:1" />
    </linearGradient>
    
    <linearGradient id="outputGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#e8f5e8;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#c8e6c9;stop-opacity:1" />
    </linearGradient>
    
    <linearGradient id="securityGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#fff3e0;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#ffcc02;stop-opacity:1" />
    </linearGradient>

    <!-- Arrow marker -->
    <defs>
      <marker id="arrowhead" markerWidth="10" markerHeight="7" 
              refX="0" refY="3.5" orient="auto">
        <polygon points="0 0, 10 3.5, 0 7" fill="#333" />
      </marker>
    </defs>
  </defs>

  <!-- Title -->
  <text x="600" y="30" text-anchor="middle" font-family="Arial, sans-serif" font-size="24" font-weight="bold" fill="#2c3e50">
    PreveraSec AppSpec++ System Architecture
  </text>

  <!-- Input Sources Layer -->
  <rect x="20" y="60" width="160" height="40" rx="5" fill="url(#inputGradient)" stroke="#01579b" stroke-width="2"/>
  <text x="100" y="85" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold">Input Sources</text>

  <!-- Individual Input Sources -->
  <rect x="30" y="120" width="140" height="25" rx="3" fill="url(#inputGradient)" stroke="#0277bd"/>
  <text x="100" y="137" text-anchor="middle" font-family="Arial, sans-serif" font-size="10">OpenAPI/Swagger</text>

  <rect x="30" y="155" width="140" height="25" rx="3" fill="url(#inputGradient)" stroke="#0277bd"/>
  <text x="100" y="172" text-anchor="middle" font-family="Arial, sans-serif" font-size="10">GraphQL SDL</text>

  <rect x="30" y="190" width="140" height="25" rx="3" fill="url(#inputGradient)" stroke="#0277bd"/>
  <text x="100" y="207" text-anchor="middle" font-family="Arial, sans-serif" font-size="10">Postman Collections</text>

  <rect x="30" y="225" width="140" height="25" rx="3" fill="url(#inputGradient)" stroke="#0277bd"/>
  <text x="100" y="242" text-anchor="middle" font-family="Arial, sans-serif" font-size="10">HAR Files</text>

  <rect x="30" y="260" width="140" height="25" rx="3" fill="url(#inputGradient)" stroke="#0277bd"/>
  <text x="100" y="277" text-anchor="middle" font-family="Arial, sans-serif" font-size="10">API Gateway Configs</text>

  <!-- Phase 1: Ingestion -->
  <rect x="250" y="60" width="160" height="40" rx="5" fill="url(#processGradient)" stroke="#4a148c" stroke-width="2"/>
  <text x="330" y="85" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold">Phase 1: Ingestion</text>

  <!-- Ingestors -->
  <rect x="260" y="120" width="140" height="25" rx="3" fill="url(#processGradient)" stroke="#6a1b9a"/>
  <text x="330" y="137" text-anchor="middle" font-family="Arial, sans-serif" font-size="10">OpenAPI Ingestor</text>

  <rect x="260" y="155" width="140" height="25" rx="3" fill="url(#processGradient)" stroke="#6a1b9a"/>
  <text x="330" y="172" text-anchor="middle" font-family="Arial, sans-serif" font-size="10">GraphQL Ingestor</text>

  <rect x="260" y="190" width="140" height="25" rx="3" fill="url(#processGradient)" stroke="#6a1b9a"/>
  <text x="330" y="207" text-anchor="middle" font-family="Arial, sans-serif" font-size="10">Postman Ingestor</text>

  <rect x="260" y="225" width="140" height="25" rx="3" fill="url(#processGradient)" stroke="#6a1b9a"/>
  <text x="330" y="242" text-anchor="middle" font-family="Arial, sans-serif" font-size="10">HAR Ingestor</text>

  <rect x="260" y="260" width="140" height="25" rx="3" fill="url(#processGradient)" stroke="#6a1b9a"/>
  <text x="330" y="277" text-anchor="middle" font-family="Arial, sans-serif" font-size="10">Gateway Ingestor</text>

  <!-- AppSpec Compiler Core -->
  <rect x="480" y="150" width="200" height="80" rx="10" fill="url(#processGradient)" stroke="#4a148c" stroke-width="3"/>
  <text x="580" y="175" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold">AppSpec Compiler</text>
  <text x="580" y="195" text-anchor="middle" font-family="Arial, sans-serif" font-size="11">4-Phase Process</text>
  <text x="580" y="210" text-anchor="middle" font-family="Arial, sans-serif" font-size="10">Ingest → Enrich</text>
  <text x="580" y="225" text-anchor="middle" font-family="Arial, sans-serif" font-size="10">Normalize → Validate</text>

  <!-- Phase 2: Enrichment -->
  <rect x="480" y="260" width="200" height="40" rx="5" fill="url(#processGradient)" stroke="#6a1b9a" stroke-width="2"/>
  <text x="580" y="285" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold">Phase 2: Enrichment</text>

  <!-- Enrichers -->
  <rect x="490" y="320" width="60" height="25" rx="3" fill="url(#processGradient)" stroke="#6a1b9a"/>
  <text x="520" y="337" text-anchor="middle" font-family="Arial, sans-serif" font-size="9">Semantic</text>

  <rect x="560" y="320" width="60" height="25" rx="3" fill="url(#processGradient)" stroke="#6a1b9a"/>
  <text x="590" y="337" text-anchor="middle" font-family="Arial, sans-serif" font-size="9">Frontend</text>

  <rect x="630" y="320" width="60" height="25" rx="3" fill="url(#processGradient)" stroke="#6a1b9a"/>
  <text x="660" y="337" text-anchor="middle" font-family="Arial, sans-serif" font-size="9">RAG</text>

  <!-- Unified AppSpec -->
  <rect x="750" y="150" width="180" height="120" rx="10" fill="url(#outputGradient)" stroke="#2e7d32" stroke-width="3"/>
  <text x="840" y="175" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold">Unified AppSpec</text>
  
  <!-- AppSpec Components -->
  <text x="760" y="195" font-family="Arial, sans-serif" font-size="10">• Endpoints & Parameters</text>
  <text x="760" y="210" font-family="Arial, sans-serif" font-size="10">• Security Schemes</text>
  <text x="760" y="225" font-family="Arial, sans-serif" font-size="10">• Frontend Context</text>
  <text x="760" y="240" font-family="Arial, sans-serif" font-size="10">• Role Matrix</text>
  <text x="760" y="255" font-family="Arial, sans-serif" font-size="10">• RAG Documentation</text>

  <!-- DAST Scanner -->
  <rect x="750" y="300" width="180" height="80" rx="10" fill="url(#securityGradient)" stroke="#f57f17" stroke-width="3"/>
  <text x="840" y="325" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold">DAST Scanner</text>
  <text x="840" y="345" text-anchor="middle" font-family="Arial, sans-serif" font-size="11">8 Vulnerability Categories</text>
  <text x="840" y="365" text-anchor="middle" font-family="Arial, sans-serif" font-size="10">OWASP/CWE Aligned</text>

  <!-- Security Tests -->
  <rect x="970" y="280" width="120" height="120" rx="5" fill="url(#securityGradient)" stroke="#f57f17" stroke-width="2"/>
  <text x="1030" y="300" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold">Security Tests</text>
  
  <text x="980" y="320" font-family="Arial, sans-serif" font-size="9">• SQL Injection</text>
  <text x="980" y="335" font-family="Arial, sans-serif" font-size="9">• XSS Detection</text>
  <text x="980" y="350" font-family="Arial, sans-serif" font-size="9">• Auth Bypass</text>
  <text x="980" y="365" font-family="Arial, sans-serif" font-size="9">• CSRF Protection</text>
  <text x="980" y="380" font-family="Arial, sans-serif" font-size="9">• Rate Limiting</text>
  <text x="980" y="395" font-family="Arial, sans-serif" font-size="9">• Data Exposure</text>

  <!-- Analysis & Reporting -->
  <rect x="750" y="420" width="340" height="60" rx="8" fill="url(#outputGradient)" stroke="#2e7d32" stroke-width="2"/>
  <text x="920" y="445" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold">Analysis & Reporting</text>
  <text x="920" y="465" text-anchor="middle" font-family="Arial, sans-serif" font-size="11">Vulnerability Reports • Coverage Analysis • Drift Detection • HTML Reports</text>

  <!-- CLI Interface -->
  <rect x="480" y="50" width="200" height="60" rx="8" fill="url(#processGradient)" stroke="#6a1b9a" stroke-width="2"/>
  <text x="580" y="75" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold">CLI Interface</text>
  <text x="580" y="95" text-anchor="middle" font-family="Arial, sans-serif" font-size="10">compile • validate • scan • diff • server</text>

  <!-- Performance Metrics Box -->
  <rect x="30" y="400" width="300" height="120" rx="8" fill="url(#outputGradient)" stroke="#2e7d32" stroke-width="2"/>
  <text x="180" y="425" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold">Performance Metrics</text>
  
  <text x="40" y="450" font-family="Arial, sans-serif" font-size="11" font-weight="bold">✅ Demo Results:</text>
  <text x="40" y="465" font-family="Arial, sans-serif" font-size="10">• 6 endpoints compiled in 156ms</text>
  <text x="40" y="480" font-family="Arial, sans-serif" font-size="10">• 100% schema coverage achieved</text>
  <text x="40" y="495" font-family="Arial, sans-serif" font-size="10">• 42 security tests executed</text>
  <text x="40" y="510" font-family="Arial, sans-serif" font-size="10">• 6 vulnerabilities detected</text>

  <!-- Data Flow Arrows -->
  <!-- Input to Ingestion -->
  <line x1="180" y1="190" x2="250" y2="190" stroke="#333" stroke-width="2" marker-end="url(#arrowhead)"/>
  
  <!-- Ingestion to Compiler -->
  <line x1="410" y1="190" x2="480" y2="190" stroke="#333" stroke-width="2" marker-end="url(#arrowhead)"/>
  
  <!-- Compiler to AppSpec -->
  <line x1="680" y1="190" x2="750" y2="210" stroke="#333" stroke-width="2" marker-end="url(#arrowhead)"/>
  
  <!-- Enrichment to Compiler -->
  <line x1="580" y1="300" x2="580" y2="230" stroke="#333" stroke-width="2" marker-end="url(#arrowhead)"/>
  
  <!-- AppSpec to DAST -->
  <line x1="840" y1="270" x2="840" y2="300" stroke="#333" stroke-width="2" marker-end="url(#arrowhead)"/>
  
  <!-- DAST to Security Tests -->
  <line x1="930" y1="340" x2="970" y2="340" stroke="#333" stroke-width="2" marker-end="url(#arrowhead)"/>
  
  <!-- Security Tests to Reports -->
  <line x1="920" y1="400" x2="920" y2="420" stroke="#333" stroke-width="2" marker-end="url(#arrowhead)"/>

  <!-- CLI Control Lines -->
  <line x1="580" y1="110" x2="580" y2="150" stroke="#666" stroke-width="2" stroke-dasharray="5,5" marker-end="url(#arrowhead)"/>

  <!-- Legend -->
  <rect x="30" y="550" width="400" height="100" rx="5" fill="#f8f9fa" stroke="#dee2e6" stroke-width="1"/>
  <text x="40" y="570" font-family="Arial, sans-serif" font-size="12" font-weight="bold">Legend:</text>
  
  <rect x="40" y="580" width="15" height="10" fill="url(#inputGradient)" stroke="#01579b"/>
  <text x="65" y="590" font-family="Arial, sans-serif" font-size="10">Input Sources</text>
  
  <rect x="160" y="580" width="15" height="10" fill="url(#processGradient)" stroke="#4a148c"/>
  <text x="185" y="590" font-family="Arial, sans-serif" font-size="10">Processing Phases</text>
  
  <rect x="40" y="600" width="15" height="10" fill="url(#outputGradient)" stroke="#2e7d32"/>
  <text x="65" y="610" font-family="Arial, sans-serif" font-size="10">Output/Results</text>
  
  <rect x="160" y="600" width="15" height="10" fill="url(#securityGradient)" stroke="#f57f17"/>
  <text x="185" y="610" font-family="Arial, sans-serif" font-size="10">Security Testing</text>

  <line x1="290" y1="585" x2="310" y2="585" stroke="#333" stroke-width="2" marker-end="url(#arrowhead)"/>
  <text x="320" y="590" font-family="Arial, sans-serif" font-size="10">Data Flow</text>

  <line x1="290" y1="605" x2="310" y2="605" stroke="#666" stroke-width="2" stroke-dasharray="3,3"/>
  <text x="320" y="610" font-family="Arial, sans-serif" font-size="10">Control Flow</text>

  <!-- Version Info -->
  <text x="1150" y="780" text-anchor="end" font-family="Arial, sans-serif" font-size="10" fill="#666">PreveraSec v1.0.0 | Phase 1</text>
  <text x="1150" y="795" text-anchor="end" font-family="Arial, sans-serif" font-size="10" fill="#666">August 2025</text>

</svg>
